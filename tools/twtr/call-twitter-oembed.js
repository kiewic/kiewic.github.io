'use strict';
const http = require('https');

function sendRequest(options) {
    return new Promise((resolve, reject) => {
        const request = http.get(options, function (response) {
            if (response.statusCode !== 200) {
                console.log(options.path);
                console.log('STATUS: ' + response.statusCode + ' ' + response.statusMessage);
                console.log('HEADERS: ' + JSON.stringify(response.headers));
                console.log();
            }

            // Buffer the body entirely for processing as a whole.
            let bodyChunks = [];
            response.on('data', function (chunk) {
                bodyChunks.push(chunk);
            }).on('end', function () {
                let body = Buffer.concat(bodyChunks);
                if (response.headers['content-type'] === 'application/json; charset=utf-8') {
                    let parsedBody = JSON.parse(body);
                    // for (const key of Object.keys(parsedBody)) {
                    //     console.log(`${key}:`, parsedBody[key]);
                    // }
                    resolve(parsedBody);
                }
                else {
                    resolve(body);
                }
            })
        });
        request.on('error', function (e) {
            console.log('ERROR: ' + e.message);
            reject(e.message);
        });
    });
}

function removeScript(content) {
    return content.replace('<script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>', '')
        .trim();
}

const urls = [
    "/bopinion/status/1317842910759571456",
    "/triketora/status/1317216266168504321",
    "/Iffitheking/status/1317274522828132352",
    "/NateSilver538/status/1316443893332955137",
    "/argyleink/status/1316143837903896577",
    "/JavaScriptDaily/status/1315417146260946945",
    "/pushtheneedle/status/1315400034989428736",
    "/danielpnorris/status/1314872024515444736",
    "/stinkypoopymel/status/1315152649583386624",
    "/swagitda_/status/1314573911686864897",
    "/flySEA/status/1314604750000668672",
    "/BvueTrans/status/1313502938971557888",
    "/BernieSanders/status/1313475366938382336",
    "/notwaldorf/status/1313246648286420993",
    "/QAGreenways/status/1310287738059382784",
    "/andreagordill/status/1309345263799205889",
    "/jongalloway/status/1309741666782199808",
    "/maikelson/status/1309158345270415360",
    "/smakosh/status/1308437503582625793",
    "/ayushi7rawat/status/1308255675848384512",
    "/bopinion/status/1305582173525864451",
    "/sulco/status/1305476685840740352",
    "/anniebombanie_/status/1304087153559965698",
    "/Apple/status/1303382180135985154",
    "/kareem_carr/status/1303360976197242881",
    "/danvdk/status/1301707026507198464",
    "/PGeVg3WB7rO6DUM/status/1301805887644823552",
    "/AmbLiuGuangYuan/status/1301168591023288320",
    "/cnni/status/1301369612790116352",
    "/yoavweiss/status/1300663417410387968",
    "/sulco/status/1300394496946057217",
    "/JavaScriptDaily/status/1300380817215156224",
    "/KSeattleWeather/status/1299884198556127232",
    "/migueldeicaza/status/1299407108388069376",
    "/migueldeicaza/status/1299395184329981953",
    "/SeattleEconomy/status/1299465587723300864",
    "/aselipsky/status/1299844309575819265",
    "/jaffathecake/status/1299311772374118401",
    "/dahlbyk/status/1298437367800434688",
    "/groogs/status/1298436854300254208",
    "/dahlbyk/status/1298421768407965697",
    "/FiveThirtyEight/status/1298446635509452800",
    "/igrigorik/status/747826527295811584",
    "/addyosmani/status/1297463776879550464",
    "/jaffathecake/status/1296382880030044160",
    "/nathanwpyle/status/1295469918654259202",
    "/xkcdComic/status/1295478837652803584",
    "/kvlly/status/1294981257042984960",
    "/threddyrex/status/1295076876944195586",
    "/b0rk/status/1295029728127135746",
    "/KSeattleWeather/status/1295198253298806784",
    "/NWSSeattle/status/1294619853580632064",
    "/kimmaicutler/status/1294324060743061504",
    "/DoliaEstevez/status/1292601681046380544",
    "/AndrewAPrice/status/1291749302428106753",
    "/AndrewAPrice/status/1291748569511268355",
    "/AndrewAPrice/status/1291746508904292354",
    "/migueldeicaza/status/1291190423764041729",
    "/migueldeicaza/status/1291185435343978497",
    "/migueldeicaza/status/1291483547321106434",
    "/batoolzamani/status/1291330337986019328",
    "/jack/status/1290697810589839363",
    "/glasstonee/status/1290726518260473862",
    "/sulco/status/1290256765758713856",
    "/mattcawby/status/1290145142322552833",
    "/Will_MI77/status/1289262399376121856",
    "/davehclark/status/1288269845281165312",
    "/argyleink/status/1287786943359549440",
    "/JavaScriptDaily/status/1287697240895741952",
    "/donsvensen/status/1287369618974269443",
    "/royalscottking/status/1287451788019294209",
    "/argyleink/status/1286936977640693761",
    "/addyosmani/status/1286564610326265856",
    "/argyleink/status/1285982916606976000",
    "/migueldeicaza/status/1285696360520523776",
    "/migueldeicaza/status/1285695533227671553",
    "/umaar/status/1284071293265022976",
    "/b0rk/status/1284528767151611904",
    "/thechadallan/status/1284749219857760256",
    "/Dev_tj_/status/1283493645367246850",
    "/annabelstrauss/status/1283149597938978817",
    "/argyleink/status/1283631698102685696",
    "/AeroimagesChris/status/1283124296089366528",
    "/argyleink/status/1282889809782927360",
    "/heidigroover/status/1282720449915318272",
    "/sharifshameem/status/1282676454690451457",
    "/ChromeDevTools/status/1283046341204041728",
    "/Slctvdplcate/status/1282255518027755521",
    "/urboigrego/status/1282281827990814720",
    "/urboigrego/status/1282281827990814720/people",
    "/addyosmani/status/1282251604276776961",
    "/alexdupler/status/1281779585445556225",
    "/addyosmani/status/1281483292026400768",
    "/natpanferova/status/1277513798853640192",
    "/NWSSeattle/status/1279627646876311553",
    "/tomayac/status/1279118273121050629",
    "/chandrikadeb7/status/1278948765269803009",
    "/NWSSeattle/status/1279058255944183808",
    "/Una/status/1278615508967981056",
    "/ChromiumDev/status/1278317306590883842",
    "/mathias/status/1278208408857051136",
    "/katiehempenius/status/1206592415190179840",
    "/katiehempenius/status/1249869361881526273",
    "/n1kflow/status/1265709217916358659",
    "/rowan_m/status/1273547127138979842",
    "/argyleink/status/1277970997275066374",
    "/InsightsMachine/status/1277891929594671105",
    "/InsightsMachine/status/1277884095129739264",
    "/patriotact/status/1277297304127582221",
    "/MoChahadeh/status/1276975774340386818",
    "/TheEllenShow/status/1276553061129953286",
    "/argyleink/status/1276562230746595328",
    "/tomwarren/status/1276515990763909120",
    "/argyleink/status/1276517319825518593",
    "/HugoGiraudel/status/801475801397030912",
    "/NHLSeattle_/status/1276216382489681922",
    "/migueldeicaza/status/1276298309892820993",
    "/seaotta/status/1275814234023055366",
    "/rob_dodson/status/1276005646559612928",
    "/BestBuy/status/1273685053869109250",
    "/argyleink/status/1275792544102862849",
    "/realDonaldTrump/status/1275599861619077121",
    "/WindowsDocs/status/1275533133614592001",
    "/CodyWebHouse/status/1275030019497005056",
    "/argyleink/status/1275430156266602497",
    "/addyosmani/status/1275322697933881344",
    "/migueldeicaza/status/1275071224389894147",
    "/GuyOron/status/1274873886140542977",
    "/argyleink/status/1275082364994101249",
    "/argyleink/status/1274728784659267584",
    "/argyleink/status/1274364131928309762",
    "/ZehEcks/status/1273943656341397505",
    "/peterframpton/status/1273640339455315970",
    "/marcorus/status/1273575014340669444",
    "/awscloud/status/1273390437848449027",
    "/moizali/status/1271949904928223233",
    "/addyosmani/status/1272423597550657537",
    "/RexChapman/status/1272184177430007808",
    "/Oseguera2020/status/1272146914230837248",
    "/denicmarko/status/1271739092292821000",
    "/kylekotajarvi/status/1271317000313167872",
    "/kcmetrobus/status/1271253267238940673",
    "/pgcornwell/status/1271221794268041217",
    "/RWhelanWSJ/status/1271417907558387713",
    "/FrickinDelanie/status/1270754386541785089",
    "/pluralsight/status/1108843464811139073",
    "/ChromeDevTools/status/1270718611405996033",
    "/realsnoopbailey/status/1270361733903929345",
    "/DewaynePerkins/status/1270053404883120129",
    "/Celticwan/status/1270333200473247744",
    "/BrandiKruse/status/1270188402420314113",
    "/MontyBoa99/status/1269078892142362625",
    "/seattletimes/status/1269261257950941184",
    "/freder1ck/status/1268611305562411013",
    "/CheriDowner/status/1268757443141677056",
    "/JohnHopperstad/status/1267485742000816129",
    "/ewufortheloss/status/1267539200846389249",
    "/Acyn/status/1267673936659021830",
    "/mattcawby/status/1267685544517005317",
    "/BellevueDotCom/status/1267313809070280704",
    "/jenatkinhair/status/1267272268926775296",
    "/factswithfiona/status/1267164884275347457",
    "/WazzupWA/status/1267345371719536640",
    "/bychadsokol/status/1267305600066568195",
    "/sundajauh/status/1267262481019224064",
    "/BrandiKruse/status/1267130856163864576",
    "/BBGVisualData/status/1266024781708775424",
    "/BrandiKruse/status/1266924674107109377",
    "/yusufyuie/status/1266917316714954753",
    "/Alfindeol/status/1266915301637058560",
    "/SweetMollyRae/status/1266877633872015362",
    "/c_clarridge/status/1266877851439005697",
    "/MLS/status/1266867154340765698",
    "/addyosmani/status/1265693572033961984",
    "/DanyalGilani/status/1263864471967203329",
    "/jaredpalmer/status/1265599702277464064",
    "/sanjaydastoor/status/1265667301526827009",
    "/ChromeUXReport/status/1265852602299842564",
    "/pushtheneedle/status/1265376508928901121",
    "/v8js/status/1265304883638480899",
    "/jeffwilcox/status/1025835421194838016",
    "/IKEAUSA/status/1257429940838043649",
    "/pushtheneedle/status/1262433085607383044",
    "/umaar/status/1263418649286754304",
    "/WithinRafael/status/1262803201905922048",
    "/addyosmani/status/1261944548160307200",
    "/AlexAegis/status/1261628107183796227",
    "/machinelearnflx/status/1261406348895371264",
    "/argyleink/status/1261033831651565568",
    "/Una/status/1260671853280014340",
    "/kotlin/status/1260955537925115904",
    "/umaar/status/1260599502496509953",
    "/typescript/status/1260331821390159872",
    "/Bob_Wachter/status/1260047922109902855",
    "/migueldeicaza/status/1259524025916837895",
    "/PowerBIguy/status/1259445723390775296",
    "/SoyElArmando/status/1259363415639887874",
    "/AzaelJBA/status/1259362189380669445",
    "/InsightsMachine/status/1258614143415808003",
    "/MayorJenny/status/1258627138602729472",
    "/bchesky/status/1258620224217071618",
    "/imhariharanr/status/1256599460580229121",
    "/JetPhotos/status/1256267663325749248",
    "/AustinJenkinsN3/status/1256337422129917953",
    "/KSeattleWeather/status/1256320720025473024",
    "/NWPBroadcasting/status/1256305322697711616",
    "/msexcel/status/1256218062828777477",
    "/addyosmani/status/1256138791166726144",
    "/DJIGlobal/status/1254100359322058752",
    "/Reuters/status/1255806601614614528",
    "/JenSchuld/status/1255921809238528000",
    "/b777xlovers/status/1253554797157859328",
    "/TheNolanK/status/1253377064880812034",
    "/mathias/status/1253242715304857601",
    "/WA_OFM/status/1253374911113879552",
    "/TitusWinters/status/1249749086791700485",
    "/ctr_peach/status/1250596776350044161",
    "/migueldeicaza/status/1250524615916630017",
    "/eugenegu/status/1249835317953097734",
    "/migueldeicaza/status/1247617259100688385",
    "/addyosmani/status/1246481431137673216",
    "/addyosmani/status/1246479192868261888",
    "/AirlineFlyer/status/1245393980025720836",
    "/csswizardry/status/1245336293250404359",
    "/zeTravelersClub/status/1245145466221846530",
    "/quynh_do/status/1245378346667687939",
    "/nycgov/status/1244634832518500352",
    "/gregpetrossian/status/1244502715167838209",
    "/Jamilebg/status/1244359406302552064",
    "/FlyAirNZ/status/1244466760297746437",
    "/addyosmani/status/1244172441146068992",
    "/marcorus/status/1243875917702758406",
    "/GovInslee/status/1243306439147278336",
    "/jeffsand/status/1242663245393154049",
    "/AndroidPolice/status/1242463699085848581",
    "/FizzyAyo04/status/1242357688287322115",
    "/shatteraheart/status/1241848699967295489",
    "/GovInslee/status/1239723516435607554",
    "/github/status/1239968032325156864",
    "/github/status/1239597562614726656",
    "/nrpilling/status/1239333732802232320",
    "/BarackObama/status/1238238576141352966",
    "/GdenisBoston/status/1239040614454435840",
    "/lillauralili/status/1239033554090119173",
    "/addyosmani/status/1239114113738997760",
    "/transitmap/status/1238898571652370432",
    "/rakyll/status/1238529966280601600",
    "/markdalgleish/status/1221887281935470596",
    "/addyosmani/status/1238026949437591554",
    "/npmjs/status/1237790424426741760",
    "/terrajobst/status/1237489207171416064",
    "/flySEA/status/1235686754453278720",
    "/stribrooks/status/1237056381464784898",
    "/Will_MI77/status/1237071935646732288",
    "/DMaslyuk/status/1236961625870987264",
    "/steipete/status/1236593910530670593",
    "/threddyrex/status/1235997813248413698",
    "/mdiep/status/1235946058745671683",
    "/migueldeicaza/status/1235951662860324865",
    "/iandraffairs/status/1235258346787069952",
    "/pushtheneedle/status/1233059531988451328",
    "/micahcohen/status/1235082065739046912",
    "/chass/status/1234526931627933696",
    "/migueldeicaza/status/1234648582025809921",
    "/hassansrfe/status/1234224993845665792",
    "/addyosmani/status/1234055782896979968",
    "/TrinAndTonic/status/1233495433684692997",
    "/ApRaider/status/1233124447462117376",
    "/addyosmani/status/1233346105842122754",
    "/kendraaaleighh/status/1232420570664333315",
    "/v8js/status/1232333889005334529",
    "/munazzzah/status/1228751525973053440",
    "/addyosmani/status/1228974800187658241",
    "/manekinekko/status/1228847354956206080",
    "/carla_huertaa/status/1228834313073983489",
    "/theavalkyrie/status/1228524855655428097",
    "/backlon/status/1225888099407785984",
    "/techledes/status/1225871090834006016",
    "/emanthecreator/status/1224125575687819264",
    "/addyosmani/status/1223191694788702208",
    "/addyosmani/status/1222421620230443010",
    "/DMLMedia/status/1221784986744868866",
    "/addyosmani/status/1221742142109966336",
    "/skuwamoto/status/1221335834919493632",
    "/QWonen4RudyAnon/status/1221643551165026306",
    "/davidmarcus/status/1221459733837516800",
    "/b0yle/status/1217241437047152645",
    "/addyosmani/status/1221379754823012352",
    "/kimmanis/status/1221190128984457216",
    "/addyosmani/status/1220609680008863746",
    "/bellevuewa/status/1220457567660531734",
    "/AristeguiOnline/status/1220053547489865728",
    "/NFLOfficiating/status/1219635867985334277",
    "/andrew__reed/status/1219030559302643712",
    "/addyosmani/status/1218435352744034304",
    "/RanjiKIRO7/status/1217824247902437381",
    "/BvuePD/status/1217485101002452992",
    "/seattledot/status/1217287376029937665",
    "/MSPowerBI/status/1217253822256615429",
    "/InsightsMachine/status/1217263060844339200",
    "/KhoiVietLe/status/1217211493688545280",
    "/wspd4pio/status/1217088704151318529",
    "/WSDOT_East/status/1217099288422957057",
    "/wspd1pio/status/1217110328531505154",
    "/FallonTonight/status/1216926702112321536",
    "/JaywalkerCM/status/1216219185258221572",
    "/SraPolvoCosmico/status/1216241388024668166",
    "/seattledot/status/1216721571852824576",
    "/AICM_mx/status/1215845789479600128",
    "/AP/status/1215982839323398150",
    "/InsightsMachine/status/1215468132136972288",
    "/InsightsMachine/status/1215467989782257665",
    "/NWSSeattle/status/1215417987794030593",
    "/argyleink/status/1214616780200562690",
    "/lasr21/status/1214942851546509312",
    "/blogdelnarcomx/status/1210955431968989191",
    "/MengTo/status/1214566827524640770",
    "/danielgross/status/1214013907003535360",
    "/esosanderelias/status/1214087046576386053",
    "/RexChapman/status/1213143056326832129",
    "/SourcedShared/status/1213035432499404801/video/1",
    "/dkhos/status/1213296446889328640",
    "/camilolara/status/1208862016351326208",
    "/tinanina013/status/1208106837045907457",
    "/maddie__morris/status/1208056106116775938",
    "/davehclark/status/1203036741289930752",
    "/migueldeicaza/status/1203186362507288577",
    "/uriel_MX2/status/1203043474926456832",
    "/SinEmbargoMX/status/1202189301330481155",
    "/PAndersonC12/status/1176109094215794689",
    "/Benioff/status/1199027693813002240",
    "/sulco/status/1198949748226613248",
    "/InsightsMachine/status/1198534861968957441",
    "/mathias/status/1196816651834068994",
    "/GlodeJo07/status/1195862494226468864",
    "/logerfo/status/1195776939522494464",
    "/TejasKumar_/status/1195401362529488897",
    "/bronwyn/status/1194628685267030016",
    "/rick_viscomi/status/1194708367530315776",
    "/TejasKumar_/status/1194689434656088065",
    "/InsightsMachine/status/1194908132809433088",
    "/InsightsMachine/status/1194834451303256065",
    "/JoshWComeau/status/1194718555083857921",
    "/AhmedXcgi/status/1194888996616376320",
    "/TejasKumar_/status/1194326690924617728",
    "/jaffathecake/status/1194271214237171712",
    "/mathias/status/1193917548875501568",
    "/zaberto/status/1193954196858507267",
    "/zaberto/status/1193954128109744129",
    "/terrymorse/status/1193983092316180480",
    "/InsightsMachine/status/1193676785096880129",
    "/riceandstirfry/status/1192941732180021248",
    "/argyleink/status/1192562385489260544",
    "/BillWixey/status/1192094919206162432",
    "/kentcdodds/status/1191922859762843649",
    "/addyosmani/status/1191049744962842624",
    "/ChinaAvReview/status/1190608583441829888",
    "/tweetvik/status/1190894839338024960",
    "/seattletimes/status/1190482920596803584",
    "/KRON4WTran/status/1190269542594826240",
    "/googledevs/status/1190247711993286657",
    "/gabriellaxmaes/status/1190050459018518529",
    "/krymski/status/1189517846562390025",
    "/triketora/status/1187294818147299328",
    "/Will_MI77/status/1187290734447222785",
    "/Ramonopolis/status/1186330465571147777",
    "/ChromiumDev/status/1186706652973674496",
    "/CiroGomezL/status/1186102553873993729",
    "/seattletimes/status/1186131747316129792",
    "/jamesdales/status/1184898393186983938",
    "/InsightsMachine/status/1183242151372541952",
    "/cH40zLord/status/1183112275227529217",
    "/JoshuaKGoldberg/status/1182791917194530816",
    "/backlon/status/1181525466789875713",
    "/googledevs/status/1182322168228483072",
    "/Michael1979/status/1181660397562159104",
    "/_Faisalismail/status/1181859042404139008",
    "/eamodio/status/1181619685088845824",
    "/paulcalvano/status/1179811066135613440",
    "/paulcalvano/status/1179811059835822080",
    "/CenturyLink_Fld/status/1179954170884837376",
    "/JamesMontemagno/status/1179290569148948481",
    "/nbcsnl/status/1178163314871939072",
    "/fakerapper/status/1178407183161028609",
    "/tomwarren/status/1178641453041557505",
    "/Superbokka/status/1178444861072199680",
    "/angular/status/1177703085193302016",
    "/tjukanov/status/956927254487068672",
    "/sulco/status/1177582358800867330",
    "/sulco/status/1177559150563344384",
    "/profgalloway/status/1175395432517775367",
    "/addyosmani/status/1174208934820728832",
    "/Tridie2000/status/1173967627875753984",
    "/shortbread131/status/1172543558819008512",
    "/github/status/1172555643271729155",
    "/isithran/status/1172480624785022977",
    "/SouthwestAir/status/1166440792040382465",
    "/FirefoxDevTools/status/1171849566817148928",
    "/niporwifi/status/1167770158326341633",
    "/typewriteralley/status/1170367986097623040",
    "/css/status/1170363603305807872",
    "/SoundTransitCEO/status/1169024119318487041",
    "/kimmanis/status/1168311292970450944",
    "/JavaScriptDaily/status/1168091124222894081",
    "/ejenk/status/1167671576541745154",
    "/cnishina/status/1165857138108821505",
    "/cnishina/status/1166705972062162946",
    "/garabatokid/status/1157204435111727105",
    "/cityofcalgary/status/1166040107364888580",
    "/praeclarum/status/1164251822720032769",
    "/arunulag/status/1162832032373678080",
    "/StackOverflow/status/1159123059825172487",
    "/cjamcl/status/1156033960389951488",
    "/addyosmani/status/1151740887149338625",
    "/AeroimagesChris/status/1152442572553326592",
    "/longwall26/status/1149726844385521665",
    "/wilsonpage/status/1149634930168590336",
    "/v8js/status/1148603966848151553",
    "/StackOverflow/status/1146105053847130117",
    "/_inside/status/1146791004915339264",
    "/bgondim/status/1143455651315748864",
    "/mathias/status/1143551692732030979",
    "/thekitze/status/1140350208439701505",
    "/Chainsman/status/1139650008016445441",
    "/katiehempenius/status/1118216456922120197",
    "/mxbck/status/1115297536770813953",
    "/addyosmani/status/1128185676191629317",
    "/lydiahallie/status/1138745610436317184",
    "/listonb/status/1003877909163995136",
    "/TalbertSwan/status/1137851454989963269",
    "/PowerBITips/status/1138154412935929857",
    "/Seth_C_Bauer/status/1138082124916056064",
    "/_inside/status/1137234174392147968",
    "/m_raffeiner/status/1136002771692511234",
    "/JavaScriptDaily/status/1135494337058549761",
    "/lopezobrador_/status/1135330456570871808",
    "/kosamari/status/1135136745698336768",
    "/ChromiumDev/status/1134916666587045888",
    "/isosteph/status/1134300635367477251",
    "/profgalloway/status/1133064027259768833",
    "/AeroSkippah/status/1132341904220278785",
    "/JuddApatow/status/1131805624444936193",
    "/_developit/status/1129093390883315712",
    "/MMarie/status/1130882617585225728",
    "/TheFatCrewTFC/status/1131029213153304576",
    "/Will_MI77/status/1130929117723938816",
    "/burkeholland/status/1130849655598735362",
    "/windowsdev/status/1124000197686845440",
    "/kosamari/status/1128467392793759746",
    "/flying_maverick/status/1128094896269799425",
    "/natfriedman/status/1127308262519390208",
    "/ChromiumDev/status/1125893925686767616",
    "/rmhrisk/status/1124362828205498368",
    "/MissAmandaN/status/1121481113950535680",
    "/_gsathya/status/1120389255619055616",
    "/bmeurer/status/1121058754890543107",
];

(async function() {
    let count = 0;
    for (const url of urls) {
        const urlEncoded = encodeURIComponent(`https://twitter.com${url}`);
        const options = {
            host: 'publish.twitter.com',
            path: `/oembed?url=${urlEncoded}`,
        };
        const result = await sendRequest(options);
        if (result.html) {
            console.log(removeScript(result.html));
        }

        if (++count == 300) {
            break;
        }
    }
})();
